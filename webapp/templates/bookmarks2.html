{% extends "layout.html" %}
{%- import "components/bookmark.html" as bookmark -%}
{%- import "components/event.html" as event -%}
{%- import "components/external.html" as external -%}

{% block content %}
<section class="section">
    <div class="container is-fluid">
        <h1 class="title">Bookmarked Events - {{ current_fosdem.year }}</h1>

        {% for timetable in timetables %}
        <div class="box">
            <h2 class="subtitle">{{ timetable.day_name }} - {{ timetable.date }}</h2>

            <div class="table-container">
                <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth">
                    <thead>
                        <tr>
                            <th style="width: 80px;">Time</th>
                            {% for room in timetable.rooms %}
                            <th>{{ room }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in timetable.rows %}
                        <tr>
                            <td>{{ row.time_slot.format("%H:%M") }}</td>
                            {% for cell in row.cells %}
                            {% match cell %}
                            {% when Some with (c) %}
                            <td rowspan="{{ c.rowspan }}"
                                data-event-id="{{ c.event.id }}"
                                data-bookmark-status="false"
                                style="vertical-align: top; padding: 0.5rem;">
                                <div class="content is-small">
                                    <strong>{{ c.event.title }}</strong>
                                    <br>
                                    <small>{{ c.event.start.format("%H:%M") }} - {{ c.event.ending_time().format("%H:%M") }}</small>
                                    <br>
                                    <small>{{ c.event.track }}</small>
                                </div>
                            </td>
                            {% when None %}
                            {% endmatch %}
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<dialog id="export-dialog">
    <div class="card">
        <header class="card-header">
            <p class="card-header-title">Export</p>
            <button class="card-header-icon copy">
                <span class="icon is-small">
                    <i class="fa-solid fa-upload"></i>
                </span>
            </button>
        </header>
        <div class="card-content">
            <textarea class="textarea is-info text" disabled></textarea>
        </div>
        <footer class="card-footer">
            <a href="#" class="card-footer-item copy">Copy</a>
            <a href="#" class="card-footer-item close">Close</a>
        </footer>
    </div>
</dialog>

<dialog id="import-dialog">
    <div class="card">
        <header class="card-header">
            <p class="card-header-title">Import</p>
            <button class="card-header-icon import">
                <span class="icon is-small">
                    <i class="fa-solid fa-download"></i>
                </span>
            </button>
        </header>
        <div class="card-content">
            <textarea class="textarea is-info text"></textarea>
        </div>
        <footer class="card-footer">
            <a href="#" class="card-footer-item import">Import</a>
            <a href="#" class="card-footer-item close">Close</a>
        </footer>
    </div>
</dialog>

{% endblock %}

{% block bookmarks_callbacks %}
<script type="module">
    import { bindExport, bindImport } from '/assets/bookmarks.js';

    document.bookmarksCallbacks = [ bindExport, bindImport ];
</script>
{% endblock %}
